function instagramFetch(e){var t=e.accessToken;var n={access_token:t};fetchCMD(n,e)}function fetchCMD(e,t){var n="";if(t.mode=="user"){n="https://api.instagram.com/v1/users/"+t.userID+"/media/recent/?callback=?"}else if(t.mode=="popular"){n="https://api.instagram.com/v1/media/popular?callback=?"}else if(t.mode=="liked"){n="https://api.instagram.com/v1/users/self/media/liked?callback=?"}else if(t.mode=="multiuser"){var r=t.userID;r=r.split(",");$.each(r,function(i){n="https://api.instagram.com/v1/users/"+r[i]+"/media/recent/?callback=?";$.getJSON(n,e,function(e){onPhotoLoaded(e,t,"off")})});return false}else{var i=t.tag.replace(/ /g,"");n="https://api.instagram.com/v1/tags/"+i+"/media/recent?callback=?"}$.getJSON(n,e,function(e){onPhotoLoaded(e,t)})}function instagramUserSearch(e){var t=e.accessToken;var n=e.user;var r={access_token:t,q:n};userSearchCMD(r,e)}function userSearchCMD(e,t){var n="https://api.instagram.com/v1/users/search?callback=?";$.getJSON(n,e,function(e){onUserLoaded(e,t)})}function onUserLoaded(e,t){if(e.meta.code==200){var n=e.data;if(n.length>0){for(var r in n){var i=n[r];var s="";s='<div class="instagram-user-all" id="p'+i.id+'" title="'+i.username+'" rel="'+i.id+'">';s+="<img src='"+i.profile_picture+"' />";s+="<span class='instagram-username'>"+i.username+"</span>";s+="<span class='instagram-fullname'>"+i.full_name+"</span>";s+="</div>";$(s).appendTo(ibObj)}$(ibObj).append('<div class="clear"></div')}}}function instagramTagsLoadMore(e){var t=e.accessToken;var n={access_token:t,max_tag_id:instagramBrowserNextMax};if(e.mode=="tag"){var r=e.tag.replace(/ /g,"")}loadMoreCMD(e,n,r)}function loadMoreCMD(e,t,n){var r="";r="https://api.instagram.com/v1/tags/"+n+"/media/recent?callback=?";$.getJSON(r,t,function(t){onPhotoLoaded(t,e)})}function instagramUsersLoadMore(e){var t=e.accessToken;var n={access_token:t,max_id:instagramBrowserNextMax};loadMoreUsersCMD(e,n)}function loadMoreUsersCMD(e,t){cmdURL="https://api.instagram.com/v1/users/"+e.userID+"/media/recent/?callback=?";$.getJSON(cmdURL,t,function(t){onPhotoLoaded(t,e)})}function onPhotoLoaded(e,t,n){if(e.pagination){if(e.pagination.next_max_tag_id){instagramBrowserNextMax=e.pagination.next_max_tag_id}else if(e.pagination.next_max_id){instagramBrowserNextMax=e.pagination.next_max_id}else{instagramBrowserNextMax="Empty"}}else{instagramBrowserNextMax="Empty"}if(e.meta.code==200){var r=e.data;if(ibObj.html()!=""){var i=true}else{var i=false}if(r.length>0){for(var s in r){var o=r[s];var u="";var a="";if(o.caption){a=o.caption.text}else{a="Instagram Media"}if(o.link==null){o.link="http://instagram.com/p/"}var f="None";if(o.videos){f=o.videos.standard_resolution.url}if(t.galleryMode=="thumbnail"){if(o.type=="video"){u='<div class="instagram-photo '+o.type+'">';u+='<video width="225" height="225" poster="'+o.images.low_resolution.url+'">';u+='  <source src="'+f+'">';u+="</video>";u+="</div>"}else{u='<a class="instagram-photo '+o.type+'" data-video ="'+f+'" href="'+o.images.standard_resolution.url+'" data-url="'+o.link+'" data-name="'+o.user.full_name+'" id="p'+o.id+'" title="'+a+" ("+o.likes.count+' Likes)" data-created="'+o.created_time+'" rel="group">';u+='<img src="'+o.images.standard_resolution.url+'" width="100%">';u+="</a>"}$(u).appendTo(ibObj)}else{var l=parseInt(o.created_time);l=new Date(l*1e3);l=dateFormat(l,"dddd, mmmm dS, yyyy, h:MM:ss TT");u='<li class="instagram-track '+o.type+'" data-poster="'+o.images.low_resolution.url+'" data-video ="'+f+'">';u+='	<img src="'+o.images.low_resolution.url+'" />';u+='	<div class="content">';u+="		<h4>"+o.user.full_name+"</h4>";u+="		<em>"+l+"</em>";u+="		<p>"+a.substring(0,196)+"</p>";u+="	</div>";u+='	<div class="clear"></div>';u+="</li>"}$(u).appendTo(ibObj.find(".video-nav ul"))}if(t.mediaType=="video"||t.galleryMode=="list"){$(".instagram-photo.image").remove();$(".instagram-track.image").remove()}var c=$(".instagram-photo").size()-1;if(i==false){$(".instagram-photo").hide()}$(".instagram-photo").each(function(e){currentPhoto=$(this);currentPhoto.delay(t.delayInterval*e).fadeIn(t.speed);$("#seachInstagramLoadMoreContainer").remove();if(e==c&&instagramBrowserNextMax!="Empty"){$('<div id="seachInstagramLoadMoreContainer"><a class="seachInstagramLoadMore btn btn-inverse">Load More</a></div>').appendTo(ibObj)}if(n=="off"){$("#seachInstagramLoadMoreContainer").remove()}});displayGalleryByType(t)}else{alert("empty")}}else{alert(e.meta.error_message)}}function displayGalleryByType(e){if(e.galleryMode=="thumbnail"){$(ibObj).show();startFancybox();startVideoPlayer(e)}if(e.galleryMode=="list"){$(ibObj).show().addClass("instagram-playlist");$(ibObj).append('<div class="clear"></div>');$("#seachInstagramLoadMoreContainer").remove();createVideo();startVideoPlayer(e);startFancybox()}}function startFancybox(){$(ibObj).find("a.instagram-photo").fancybox({arrows:true,helpers:{title:{type:"inside"}}})}function createVideo(e){var t=$(".instagram-playlist .video-nav li").eq(0).attr("data-poster");var n=$(".instagram-playlist .video-nav li").eq(0).attr("data-video");if(e){t=e.attr("data-poster");n=e.attr("data-video")}var r="";r+='<video width="480" height="480" poster="'+t+'" tabindex="0">';r+='    <source src="'+n+'"></source>';r+="</video>";$(".instagram-photo.video").html("").append(r)}function startVideoPlayer(e){var t=["playpause","progress","volume","fullscreen"];if(e.showControls==false){t=[""]}$(".instagram-photo video").mediaelementplayer({alwaysShowControls:false,videoVolume:"horizontal",features:t});if(e.showControls==false){$(".mejs-controls").remove()}}var ibObj;var instagramBrowserNextMax;$.fn.instagramVideo=function(e){var t={mode:"popular",accessToken:"XX-XX-XXXX",userID:"1138644",speed:700,delayInterval:80,tag:"sports",galleryMode:"thumbnail",mediaType:"video",showControls:true};ibObj=$(this);$.extend(t,e);return this.each(function(){$(document).ready(function(){if(t.galleryMode=="list"){var e="";e+='<div class="instagram-photo video"></div>';e+='<div class="video-nav">';e+="    <ul></ul>";e+='	   <div class="controls">';e+='		  <span class="arrow-up"></span>';e+='		  <span class="arrow-down"></span>';e+="	   </div>";e+="</div>";$(ibObj).append(e)}instagramFetch(t);$(document).on("click",".seachInstagramLoadMore",function(){if(t.mode=="tag"){instagramTagsLoadMore(t)}else if(t.mode=="user"){instagramUsersLoadMore(t)}});$("#searchByTag .submit").click(function(){ibObj.html("");var e=t;e.mode="tag";e.tag=$("input.searchTag").val().replace(/ /g,"");if(e.tag==""){alert("Please enter a valid hashtag.");return false}instagramFetch(e);return false});$("#searchByUser .submit").click(function(){ibObj.html("");var e=t;e.mode="user";e.user=$("input.searchUser").val().replace(/ /g,"");if(e.user==""){alert("Please enter a valid username.");return false}instagramUserSearch(e);return false});$(document).on("click",".instagram-user-all",function(){ibObj.html("");var e=t;e.mode="user";e.userID=$(this).attr("rel");instagramFetch(e)});$(document).on("click",".video-nav .arrow-down",function(){$(".video-nav ul").stop().animate({scrollTop:"+=200"},500)});$(document).on("click",".video-nav .arrow-up",function(){$(".video-nav ul").stop().animate({scrollTop:"-=200"},500)});$(document).on("click",".instagram-track.video",function(){createVideo($(this));startVideoPlayer(t)})})})}